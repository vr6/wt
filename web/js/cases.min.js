var $jscomp={scope:{},checkStringArgs:function(a,f,e){if(null==a)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return a+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,e){if(e.get||e.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[f]=e.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,f,e,d){if(f){e=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var b=a[d];b in e||(e[b]={});e=e[b]}a=a[a.length-1];d=e[a];f=f(d);f!=d&&null!=f&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,e){var d=$jscomp.checkStringArgs(this,a,"startsWith");a+="";for(var b=d.length,f=a.length,l=Math.max(0,Math.min(e|0,d.length)),h=0;h<f&&l<b;)if(d[l++]!=a[h++])return!1;return h>=f}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,e,d){var b=this.length||0;0>e&&(e=Math.max(0,b+e));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(e=Number(e||0);e<d;e++)this[e]=a;return this}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,e){var d=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===e&&(e=d.length);for(var b=Math.max(0,Math.min(e|0,d.length)),g=a.length;0<g&&0<b;)if(d[--b]!=a[--g])return!1;return 0>=g}},"es6-impl","es3");msloaded=!0;changes={};mseries=[];mstats={};mstot={};cfdtstat=[];mpage=1;eacmstot={};wacmstot={};wacmstatstot=eacmstatstot=0;var eac2=[],wac2=[];eaccfdtstat=[];waccfdtstat=[];sdetail=[];vcaseid=seriesrow=null;
Chart.defaults.global.defaultFontColor="#fff";function init(){loadmseries()}function getMsbg(a){a=mseries.indexOf(a);if(-1==a)return"#fff";a=mstats[a];if(a.chguser.startsWith("*"))return"#ccffff";switch(getAgeDays(a.chgdt)){case 0:return"#bbf8bb";case 1:return"#f6faaa";case 2:return"#ffddaa";case 3:return"#ffc8e0"}return"#dce4ff"}
function getAgeDays(a){a=a.split(" ")[0].split("-");a=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),0,0,0);a.setTime(a.getTime()-6E4*a.getTimezoneOffset());return Math.floor(Math.floor((new Date-a)/1E3)/86400)}
function loadmseries(){if(msloaded){eacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};wacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};for(var a=0;45>a;a++)eac2[a]=Array(6).fill(0);for(a=0;45>a;a++)wac2[a]=Array(6).fill(0);msloaded=!1;$("#infoToggler").attr("src","tracker/img/refresh.gif");$.getJSON("/api/data/vcases18/test?a=mseries",function(a){mstats=a;a=null;var e=!0;eaccfdtstat=[0,0,0,0,0,0,0];waccfdtstat=[0,0,0,0,0,0,0];for(var d=wacmstatstot=eacmstatstot=0;d<mstats.length;d++){var b=
mstats[d];b.id.startsWith("EAC")?eacmstatstot++:wacmstatstot++;var g=parseInt(b.id.substring(5,8)),f=parseInt(b.id.substring(8,10));"E"==b.id.charAt(0)?eac2[g-130][f-50]=1:wac2[g-130][f-50]=1;null==a&&(a=b.chgdt.substring(0,10));a==b.chgdt.substring(0,10)?mstats[d].cdt=!1:(e=!1,mstats[d].cdt=!0,a=b.chgdt.substring(0,10));changes[b.id]=b.chgs;mseries.push(b.id);g=b.id.startsWith("EAC")?eacmstot:wacmstot;g.rec+=b.rec;g.wtd+=b.wtd;g.rfe+=b.rfe;g.rrr+=b.rrr;g.app+=b.app;g.dnm+=b.dnm;g.chg+=""==b.chgs?
0:b.chgs.split(",").length;b.eactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};b.wactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};g=b.id.startsWith("EAC")?b.eactchgs:b.wactchgs;if(null!=b.chgst){for(var f=b.chgst.split(","),h=0;h<f.length;h++)f[h].endsWith("7")?g.cresp++:f[h].endsWith("8")?g.cdnm++:f[h].endsWith("3")?g.crfe++:"71"==f[h]?g.app2++:f[h].endsWith("1")&&g.app1++;b.tchgs=g;b.id.startsWith("EAC");e&&(eaccfdtstat[0]+=""==b.chgs||b.id.startsWith("WAC")?0:b.chgs.split(",").length,eaccfdtstat[1]+=
b.eactchgs.crfe,eaccfdtstat[2]+=b.eactchgs.cresp,eaccfdtstat[3]+=b.eactchgs.cdnm,eaccfdtstat[4]+=b.eactchgs.app1,eaccfdtstat[5]+=b.eactchgs.app2,waccfdtstat[0]+=""==b.chgs||b.id.startsWith("EAC")?0:b.chgs.split(",").length,waccfdtstat[1]+=b.wactchgs.crfe,waccfdtstat[2]+=b.wactchgs.cresp,waccfdtstat[3]+=b.wactchgs.cdnm,waccfdtstat[4]+=b.wactchgs.app1,waccfdtstat[5]+=b.wactchgs.app2)}}msloaded=!0;$("#infoToggler").attr("src","tracker/img/refresh.png");caselist();vcaseid||(vcaseid=mseries[Math.floor(Math.random()*
mseries.length)],getvcase(vcaseid,"latest",null,!1))})}}
function caselist(){stbl=document.getElementById("seriestbl");stbl.getElementsByTagName("tr");for(var a=stbl.rows.length,f=1;f<a;f++)stbl.deleteRow(-1);for(a=0;45>a;a++){f=stbl.insertRow();f.innerHTML='<td class="cd">'+(130+a)+"</td>";var e=f.insertCell();for(k=0;6>k;k++){var d=document.createElement("DIV");d.classList.add("s");d.style.backgroundColor=getMsbg("EAC18"+(130+a)+(50+k));d.id="EAC18"+(130+a)+(50+k);-1!=mseries.indexOf(d.id)?d.onclick=function(){getvcase(this.id,null,null,!0)}:d.style.color=
"#ccc";d.innerHTML="<span>"+(50+k)+"</span>";e.appendChild(d)}f.insertAdjacentHTML("beforeend",'<td class="cd">'+(130+a)+"</td>");e=f.insertCell();for(k=0;6>k;k++)d=document.createElement("DIV"),d.classList.add("s"),d.style.backgroundColor=getMsbg("WAC18"+(130+a)+(50+k)),d.id="WAC18"+(130+a)+(50+k),-1!=mseries.indexOf(d.id)?d.onclick=function(){getvcase(this.id,null,null,!0)}:d.style.color="#ccc",d.innerHTML="<span>"+(50+k)+"</span>",e.appendChild(d)}}
function casegrid(){var a=document.getElementById("casegrid");document.getElementById("caseheader").innerHTML='<span style="background-color: '+getMsbg(vcase.id)+';border:1px solid #888; border-radius:50%"> &nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp; <span style="font-size:20px;">'+vcase.id+"</b>&nbsp;&nbsp;</span>"+vcase.dt+' &nbsp;&nbsp;<span style="font-size:14px;" ng-hide="changes[vcase.id] == null">Update : '+timeago(vcase.chgdt)+' ago by <span style="color:#00a;">'+vcase.chguser+"</span></span> ";
for(var f=document.getElementById("tbl"),e=f.rows.length;e--;)f.deleteRow(e);e=f.insertRow();e.insertCell();for(var d=0;100>d;d++){var b=e.insertCell();b.innerText=0==d%10?""+d/10:0==d%5?"*":""}for(d=0;10>d;d++){e=f.insertRow();b=e.insertCell();b.innerText=""+d;for(var g=0;100>g;g++)b=e.insertCell(),b.id=vcase.id+d+(10>g?"0"+g:g),b.onclick=function(){history(this.id)},b.title=b.id+" "+getDetail(100*d+g),b.style.backgroundColor=getColor(100*d+g),b.style.border=getBorder(vcase.id,100*d+g)}a.appendChild(f);
e=document.getElementById("gridtotals");e.innerHTML='Received: <span style="color: blue">'+sdetail[0]+'</span>&nbsp;&nbsp;&nbsp;RFE Req Mailed: <span style="color: blue">'+sdetail[3]+'</span>&nbsp;&nbsp;&nbsp;RFE Resp Recv.: <span style="color: blue">'+sdetail[7]+'</span>&nbsp;&nbsp;&nbsp;Transferred: <span style="color: blue">'+sdetail[6]+'</span>&nbsp;&nbsp;&nbsp;Decision Notice: <span style="color: blue">'+sdetail[8]+'</span>&nbsp;&nbsp;&nbsp;Approved: <span style="color: blue">'+sdetail[1]+"</span>&nbsp;&nbsp;&nbsp;"}
clr={0:"#ee0",1:"#0c0",2:"#fa6",3:"#fbf",4:"#ace",5:"#fff",6:"#bb0",7:"#eb0",8:"#07e",9:"#a60",a:"#4f0"};echg={0:"Received",1:"Approved",2:"Rejected",3:"RFE",4:"Other",5:"Not I-129",6:"Transferred",7:"RFE Resp",8:"DNM",9:"Withdrawn",a:"RFE-Approved"};function getColor(a){c=res.length>a?res[a].charAt(0):"5";return clr[c]}
function getDetail(a){csa=res.length>a?res[a]:"5";return void 0==csa||"5"==csa?"":echg[csa.charAt(0)]+" "+parseInt(csa.charAt(1),36)+"-"+parseInt(csa.charAt(2),36)+"-"+parseInt(csa.charAt(3),36)}function getClz(a){return"c"+a}function getBorder(a,f){return-1!=(","+changes[a]+",").indexOf(","+f+",")?"2px solid #008":""}
var chgloaded=!1,imagedata=null,statnames={0:"Received",1:"Approved",2:"Rejected",3:"RFE Req",4:"Other",5:"Not Form I-129",6:"Transferred",7:"RFE resp rec",8:"Decision Notice",9:"Withdrawn",a:"RFE-Approved"};
function history(a){document.getElementById("historytitle").innerText="Case History - "+a;getHttp("/api/data/vcases18/?a=history&casenum="+a,function(a){chgloaded=!0;imgdata="data:image/png;base64,"+a;document.getElementById("historyimg").src=imgdata;document.getElementById("historytbl").style.display=""})}function getStatus(a){return statnames[a]}var res=[];
function getvcase(a,f,e,d){null!=a&&(vcaseid=a,$.getJSON("/api/data/vcases18/vcaseform?vcase="+vcaseid+(void 0==f?"":"&nav="+f+"&dt="+e),function(a){if("empty"!=a){seriesrow=null;d&&$("html, body").animate({scrollTop:$("#seriesgrid").offset().top},1E3);vcase=a;res=vcase.data.split(",");var b=[0,0,0,0,0,0,0,0,0];for(a=0;a<res.length;a++)switch(res[a].charAt(0)){case "0":b[0]++;break;case "a":b[1]++;break;case "1":b[1]++;break;case "2":b[2]++;break;case "3":b[3]++;break;case "4":b[4]++;break;case "5":b[5]++;
break;case "6":b[6]++;break;case "7":b[7]++;break;case "8":b[8]++}sdetail=b;console.log("res="+res.length);casegrid();document.getElementById("progtitle").innerHTML="Series Progress - "+vcase.id;var b=document.getElementById("schart").getContext("2d"),e=[];for(a=0;a<vcase.stats.length;a++)e.push(vcase.stats[a].dt.substring(5));var f=[];for(a=0;a<vcase.stats.length;a++)f.push(vcase.stats[a].rec);var m=[];for(a=0;a<vcase.stats.length;a++)m.push(vcase.stats[a].app);var n=[];for(a=0;a<vcase.stats.length;a++)n.push(vcase.stats[a].rfe);
var p=[];for(a=0;a<vcase.stats.length;a++)p.push(vcase.stats[a].rrr);var q=[];for(a=0;a<vcase.stats.length;a++)q.push(vcase.stats[a].dnm);new Chart(b,{type:"line",data:{labels:e,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:f},{borderColor:window.chartColors.rfe,label:"RFE",data:n},{borderColor:window.chartColors.rrr,label:"RESP",data:p},{borderColor:window.chartColors.app,label:"APP",data:m},{borderColor:window.chartColors.dnm,label:"DNM",data:q}]},options:{title:{display:!1},tooltips:{mode:"index",
intersect:!1},responsive:!0,elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0}}]}}})}}))}window.chartColors={rec:"#cc0",rfe:"#f8d",rrr:"#eca",dnm:"#09f",oth:"#8ce",app:"#0b0",trf:"#b84",wtd:"#c64"};
function timeago(a){if(void 0==a)return"";var f=a.split(" ");a=f[0].split("-");f=f[1].split(":");a=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),parseInt(f[0]),parseInt(f[1]),parseInt(f[2]));a.setTime(a.getTime()-6E4*a.getTimezoneOffset());a=Math.floor((new Date-a)/1E3);return 31536E3<=a?(a=Math.floor(a/31536E3),a+(1<a?" years":"year")):2592E3<=a?(a=Math.floor(a/2592E3),a+(1<a?" months":" month")):86400<=a?(a=Math.floor(a/86400),a+(1<a?" days":" day")):3600<=a?(a=Math.floor(a/3600),a+(1<
a?" hrs":" hr")):60<=a?(a=Math.floor(a/60),a+" min"):a+" sec"}function getHttp(a,f){var e=new XMLHttpRequest;e.onreadystatechange=function(){e.readyState==XMLHttpRequest.DONE&&f(e.responseText)};e.onerror=function(){console.log("There was a connection error of some sort")};e.open("GET",a,!0);e.send()};
