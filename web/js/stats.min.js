var $jscomp={scope:{},checkStringArgs:function(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,c,d,a){if(c){d=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var k=b[a];k in d||(d[k]={});d=d[k]}b=b[b.length-1];a=d[b];c=c(a);c!=a&&null!=c&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(c,b){var a=$jscomp.checkStringArgs(this,c,"endsWith");c+="";void 0===b&&(b=a.length);for(var d=Math.max(0,Math.min(b|0,a.length)),m=c.length;0<m&&0<d;)if(a[--d]!=c[--m])return!1;return 0>=m}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(c,b){var a=$jscomp.checkStringArgs(this,c,"startsWith");c+="";for(var d=a.length,m=c.length,r=Math.max(0,Math.min(b|0,a.length)),f=0;f<m&&r<d;)if(a[r++]!=c[f++])return!1;return f>=m}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(c,b,a){var d=this.length||0;0>b&&(b=Math.max(0,d+b));if(null==a||a>d)a=d;a=Number(a);0>a&&(a=Math.max(0,d+a));for(b=Number(b||0);b<a;b++)this[b]=c;return this}},"es6-impl","es3");angular.module("statsApp",["ngRoute","ngAnimate","ui.bootstrap","usermodule"]);
angular.module("statsApp").config(["$routeProvider",function(b){b.when("/welcome17",{templateUrl:"tracker/welcome.html"});b.when("/jobs",{templateUrl:"tracker/jobs.html",controller:"joblistCtrl"});b.when("/rferes",{templateUrl:"tracker/rferes.html",controller:"rferesCtrl"});b.when("/help",{templateUrl:"tracker/help.html"});b.when("/welcome18",{templateUrl:"tracker17/welcome.html"});b.when("/welcome19",{templateUrl:"tracker18/welcome.html"});b.when("/404",{templateUrl:"404.html"});b.otherwise({redirectTo:"/welcome19"})}]);
function getTemp(b){return"/api/temp/rep?a="+b}angular.module("statsApp").run(["$rootScope","$templateCache",function(b,c){b.$on("$routeChangeStart",function(b,a,k){c.removeAll()});b.$on("$viewContentLoaded",function(){c.removeAll()})}]);angular.module("statsApp").constant("tzconfig",{pk_tz_obj:1,pk_tz_comp:2,pk_tz_coltype:3,pk_tz_col:4,pk_tz_rel:5,pk_tz_action:6});
angular.module("statsApp").config(["$httpProvider",function(b){b.interceptors.push(["$q","$location",function(c,b){return{request:function(a){console.log("req="+a.url);return a},responseError:function(a){console.log("error:"+a);404===a.status&&b.path("/404");return c.reject(a)},response:function(a){console.log("res-status="+a.status);switch(a.status){case 200:return a;case 404:b.path("/404");break;default:b.path("/error")}}}}])}]);
angular.module("statsApp").service("anchorSmoothScroll",function(){this.scrollTo=function(b){var c=self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0,d=document.getElementById(b);for(b=d.offsetTop;d.offsetParent&&d.offsetParent!=document.body;)d=d.offsetParent,b+=d.offsetTop;var a=b>c?b-c:c-b;if(100>a)scrollTo(0,b);else{d=Math.round(a/100);20<d&&(d=20);var a=Math.round(a/
25),k=b>c?c+a:c-a,m=0;if(b>c)for(;c<b;c+=a)setTimeout("window.scrollTo(0, "+k+")",m*d),k+=a,k>b&&(k=b),m++;else for(;c>b;c-=a)setTimeout("window.scrollTo(0, "+k+")",m*d),k-=a,k<b&&(k=b),m++}}});angular.module("statsApp").filter("range",function(){return function(b,c){c=parseInt(c);for(var d=0;d<c;d++)b.push(d);return b}});angular.module("statsApp").filter("plus",function(){return function(b){return 0<b?"+"+b:b}});
angular.module("statsApp").filter("dash",function(){return function(b){return void 0==b||null==b||""==b?"-":b}});angular.module("statsApp").filter("rounded",function(){return function(b){return parseInt(b,10)}});angular.module("statsApp").filter("round",function(){return function(b){return Math.round(b)}});
angular.module("statsApp").filter("emot",function(){return function(b){for(var c="",d=0,a=0;a<b.length;a++)67<b[a]&&(c+=b.substring(d,a),c+="<span style='font-size:32px'>"+b[a]+"</span>",d=a+1);d<b.length&&(c+=b.substring(d,b.length));return c}});angular.module("statsApp").filter("clip",function(){return function(b){return 13>b.length?b:b.substring(0,10)+"..."}});angular.module("statsApp").filter("reverse",function(){return function(b){return b.slice().reverse()}});
angular.module("statsApp").filter("escape",function(){return window.encodeURIComponent});
angular.module("statsApp").filter("timeago",function(){return function(b){if(void 0==b)return"";var c=b.split(" ");b=c[0].split("-");c=c[1].split(":");b=new Date(parseInt(b[0]),parseInt(b[1])-1,parseInt(b[2]),parseInt(c[0]),parseInt(c[1]),parseInt(c[2]));b.setTime(b.getTime()-6E4*b.getTimezoneOffset());b=Math.floor((new Date-b)/1E3);return 31536E3<=b?(b=Math.floor(b/31536E3),b+(1<b?" years":"year")):2592E3<=b?(b=Math.floor(b/2592E3),b+(1<b?" months":" month")):86400<=b?(b=Math.floor(b/86400),b+(1<
b?" days":" day")):3600<=b?(b=Math.floor(b/3600),b+(1<b?" hrs":" hr")):60<=b?(b=Math.floor(b/60),b+" min"):b+" sec"}});
angular.module("statsApp").constant("countries",[{code:"in",name:"India"},{code:"us",name:"United States"},{code:"gb",name:"United Kingdom"},{code:"au",name:"Australia"},{code:"sg",name:"Singapore"},{code:"ca",name:"Canada"},{code:"cn",name:"China"},{code:"ph",name:"Philippines"},{code:"ar",name:"Argentina"},{code:"at",name:"Austria"},{code:"bh",name:"Bahrain"},{code:"be",name:"Belgium"},{code:"br",name:"Brazil"},{code:"cl",name:"Chile"},{code:"co",name:"Colombia"},{code:"cr",name:"Costa Rica"},{code:"cz",
name:"Czech Republic"},{code:"dk",name:"Denmark"},{code:"ec",name:"Ecuador"},{code:"eg",name:"Egypt"},{code:"fi",name:"Finland"},{code:"fr",name:"France"},{code:"de",name:"Germany"},{code:"gr",name:"Greece"},{code:"hk",name:"Hong Kong"},{code:"hu",name:"Hungary"},{code:"id",name:"Indonesia"},{code:"ie",name:"Ireland"},{code:"il",name:"Israel"},{code:"it",name:"Italy"},{code:"jp",name:"Japan"},{code:"kw",name:"Kuwait"},{code:"lu",name:"Luxembourg"},{code:"my",name:"Malaysia"},{code:"mx",name:"Mexico"},
{code:"ma",name:"Morocco"},{code:"nl",name:"Netherlands"},{code:"nz",name:"New Zealand"},{code:"ng",name:"Nigeria"},{code:"no",name:"Norway"},{code:"om",name:"Oman"},{code:"pk",name:"Pakistan"},{code:"pa",name:"Panama"},{code:"pe",name:"Peru"},{code:"pl",name:"Poland"},{code:"pt",name:"Portugal"},{code:"qa",name:"Qatar"},{code:"ro",name:"Romania"},{code:"ru",name:"Russia"},{code:"sa",name:"Saudi Arabia"},{code:"za",name:"South Africa"},{code:"kr",name:"South Korea"},{code:"es",name:"Spain"},{code:"se",
name:"Sweden"},{code:"ch",name:"Switzerland"},{code:"tw",name:"Taiwan"},{code:"th",name:"Thailand"},{code:"tr",name:"Turkey"},{code:"ae",name:"UAE"},{code:"ua",name:"Ukraine"},{code:"uy",name:"Uruguay"},{code:"ve",name:"Venezuela"},{code:"vn",name:"Vietnam"}]);angular.module("usermodule",["ui.bootstrap"]);
angular.module("usermodule").factory("usersvc",["$http","$rootScope","$uibModal",function(b,c,d){return{login:function(a){d.open({animation:!0,templateUrl:"login.html",controller:"logindlgCtrl",size:"sm"}).result.then(function(c){console.log("loginst="+c);a(c)},function(){console.log("Modal dismissed");a("cancel")})},signup:function(a){d.open({animation:!0,templateUrl:"signup.html",controller:"addAccountCtrl",size:"sm"}).result.then(function(c){console.log("signupst="+c);a(c)},function(){a("cancel")})},
logout:function(a){b.post("/api/user/test?a=logout").success(function(c,b,d,f){a("success")})},setprof:function(a,c){b.post("/api/user/test?a=setprof&profid="+a).success(function(a,b,f,h){console.log("profile="+a);localStorage.setItem("wtprofile",JSON.stringify(a));c("success")})},checklogin:function(a){b.get("/api/user/test?a=checklogin").success(function(c,b,d,f){a(c)})}}}]);
angular.module("usermodule").controller("addAccountCtrl",["$scope","$http","$uibModalInstance",function(b,c,d){b.error="";b.ok=function(){var a=b.user;null==a.userid||4>a.userid.trim().length?b.error="User id needs atleast 4 letters":c.get("/api/user/test?a=checkuserid&id="+a.userid).success(function(d,m,r,f){console.log(d.status);"success"==d.status?c.post("/api/user/test?a=signup",a).success(function(c,f,g,l){console.log(c.status);"invalid_auth"==c.status?b.error="Invalid authentication":b.emailtxt=
"Hi "+a.userid+",\n\nThanks for offering to help!!\n\nFor running the data updates at worktheme, you would need to have the python software installed on your laptop. If you have a Mac, it should already be there. Otherwise you can download python from \n\nhttps://www.python.org/downloads/release/python-2712/\n\nOn the download site, choose appropriate installer bundle based on your laptop type:\n\nFor windows:\nhttps://www.python.org/ftp/python/2.7.12/python-2.7.12.amd64.msi\n\nFor Mac:\nhttps://www.python.org/ftp/python/2.7.12/python-2.7.12-macosx10.6.pkg\n\nOnce you have installed python, please download the small script file from the following URL. You need to save it on your laptop. It also has instructions - you can open it in a text editor, read instructions and run it from command line for updating the series.\n\nhttps://worktheme.com/YJUPFcqL/update19.py\n\nFollowing is your own token. You will need this to run the tracker update\n\n"+
a.token+"\n\nFor adding a new series, you will need this to run the following\n\nhttps://worktheme.com/YJUPFcqL/tracker19.py\n\nDon't hesitate to ask for help, whenever you need it, either through email or through comments.\n\nThanks for helping!\n\nVenkat Reddy\nworktheme.com\n"}):"id_exists"==d.status&&(b.error="That user id is already taken. Please try a different one.")})};b.cancel=function(){d.dismiss("cancel")}}]);
angular.module("usermodule").controller("logindlgCtrl",["$scope","$http","$window","$uibModalInstance",function(b,c,d,a){b.error="";b.ok=function(){var k=b.user;null==k.userid||4>k.userid.trim().length?b.error="User id needs atleast 4 letters":null==k.pass||6>k.pass.trim().length?b.error="Password needs atleast 6 letters":(k=d.btoa(k.userid+":"+k.pass),console.log("authdata="+k),c.defaults.headers.common.Authorization="Basic "+k,c.post("/api/user/test?a=login").success(function(c,d,f,h){null==c?b.error=
"Error while logging in. Please try again later.":a.close("success")}).error(function(a,c){401==c&&(b.error="Invalid input. Please try again.")}))};b.cancel=function(){a.dismiss("cancel")}}]);angular.module("usermodule").controller("appsCtrl",["$scope","$uibModalInstance",function(b,c){b.error="";b.ok=function(b){console.log("ok="+b);c.close(b)};b.cancel=function(){c.dismiss("cancel")}}]);window.chartColors={rec:"#cc0",rfe:"#f8d",rrr:"#eca",dnm:"#09f",oth:"#8ce",app:"#0b0",trf:"#b84",wtd:"#c64"};
Chart.defaults.global.defaultFontColor="#fff";window.getopts=function(b){return{type:"bar",data:b,options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{barThickness:4,ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1},stacked:!0}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{max:80,beginAtZero:!0},stacked:!0}]}}}};
angular.module("statsApp").controller("vcaselistCtrl",["$http","$scope","$rootScope","anchorSmoothScroll","$location","$uibModal","$log",function(b,c,d,a,k,m,r){c.loadvcases=function(){b.get("/api/data/vcases/stackedcols?pre=EAC").success(function(a,c,e,b){c=[];e=[];b=[];for(var f=[],h=[],g=0;g<a.length;g++)c.push(a[g].id.substring(5,8)+"-"+a[g].id.substring(8,10)),e.push(a[g].rec),b.push(a[g].rfe),f.push(a[g].rrr),h.push(a[g].oth);a={labels:c,backgroundColor:"rgba(185, 214, 200, 0.75)",borderColor:"rgba(255, 255, 255, 0.5)",
datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:e},{backgroundColor:window.chartColors.rfe,label:"RFE",data:b},{backgroundColor:window.chartColors.rrr,label:"RESP",data:f},{backgroundColor:window.chartColors.oth,label:"OTH",data:h}]};c=document.getElementById("canvas_eac").getContext("2d");window.myBar=new Chart(c,window.getopts(a))});b.get("/api/data/vcases/stackedcols?pre=WAC").success(function(a,c,b,g){c=[];b=[];g=[];for(var f=[],e=[],h=0;h<a.length;h++)c.push(a[h].id.substring(5,
8)+"-"+a[h].id.substring(8,10)),b.push(a[h].rec),g.push(a[h].rfe),f.push(a[h].rrr),e.push(a[h].oth);a={labels:c,backgroundColor:"rgba(185, 214, 200, 0.75)",borderColor:"rgba(255, 255, 255, 0.5)",datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:b},{backgroundColor:window.chartColors.rfe,label:"RFE",data:g},{backgroundColor:window.chartColors.rrr,label:"RESP",data:f},{backgroundColor:window.chartColors.oth,label:"OTH",data:e}]};c=document.getElementById("canvas_wac").getContext("2d");
window.myBar=new Chart(c,window.getopts(a))})};c.loadvcases();c.eac=[2,2,1,2,2,3,2,2,1,4,5,5,5,5,2,6,6,6,6,6,2,6,7,6,6];c.wac=[1,1,1,1,2,3,3,1,3,5,5,5,4,2,5,4,5,5,5,2,5,5,5,3,3];c.sbs=[[150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],[150,151,155,158,161,166,167,169,171,172,173,177,182,184,186,198],[150,151,161,166,167,169,172,186,198],[150,151,172]];
c.msloaded=!1;c.sortcol="dt";c.sortdir="desc";c.loadmseries=function(a,h){c.msloaded=!1;c.changes={};c.mseries=[];c.mstot={rec:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};b.get("/api/data/vcases/test?a=mseries&sortcol="+a+"&sortdir="+h).success(function(a,b,f,h){c.mstats=a;a=null;b=!0;f=[0,0,0,0,0,0];for(h=0;h<c.mstats.length;h++){var e=c.mstats[h];null==a&&(a=e.chgdt.substring(0,10));a==e.chgdt.substring(0,10)?c.mstats[h].cdt=!1:(b=!1,c.mstats[h].cdt=!0,a=e.chgdt.substring(0,10));c.changes[e.id]=e.chgs;c.mseries.push(e.id);
c.mstot.rec+=e.rec;c.mstot.rfe+=e.rfe;c.mstot.rrr+=e.rrr;c.mstot.app+=e.app;c.mstot.dnm+=e.dnm;c.mstot.chg+=""==e.chgs?0:e.chgs.split(",").length;e.tchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};if(null!=e.chgst){for(var l=e.chgst.split(","),g=0;g<l.length;g++)l[g].endsWith("7")?e.tchgs.cresp++:l[g].endsWith("8")?e.tchgs.cdnm++:l[g].endsWith("3")?e.tchgs.crfe++:"01"==l[g]?e.tchgs.app1++:"71"==l[g]&&e.tchgs.app2++;b&&(f[0]+=""==e.chgs?0:e.chgs.split(",").length,f[1]+=e.tchgs.crfe,f[2]+=e.tchgs.cresp,
f[3]+=e.tchgs.cdnm,f[4]+=e.tchgs.app1,f[5]+=e.tchgs.app2)}}c.msloaded=!0;c.vcaseid||(c.vcaseid=c.mseries[Math.floor(Math.random()*c.mseries.length)],c.getvcase(c.vcaseid,"latest",null,!1));c.cfdtstat=f})};c.loadmseries(c.sortcol,c.sortdir);b.get("/api/data/vcases/test?a=getadmins").success(function(a,b,e,g){c.admins=a});c.setsort=function(a){c.sortdir=c.sortcol==a?""==c.sortdir?"desc":"":"dt"==a?"desc":"";c.sortcol=a;c.loadmseries(c.sortcol,c.sortdir)};c.sortclr=function(a){return c.sortcol==a?""==
c.sortdir?"#cdf":"#fdc":""};c.vcaseform=function(a){k.path("/vcases/"+a)};c.getAgeDays=function(a){a=a.split(" ")[0].split("-");a=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),0,0,0);a.setTime(a.getTime()-6E4*a.getTimezoneOffset());return Math.floor(Math.floor((new Date-a)/1E3)/86400)};c.getMsbg=function(a){a=c.mseries.indexOf(a);if(-1==a)return"#fff";a=c.mstats[a];if(a.chguser.startsWith("*"))return"#ccffff";switch(c.getAgeDays(a.chgdt)){case 0:return"#bbf8bb";case 1:return"#f6faaa";case 2:return"#ffddaa";
case 3:return"#ffc8e0"}return"#dce4ff"};c.getvcase=function(f,h,e,g){console.log("getvcase called");null!=f&&(console.log("getvcase api called"),c.vcaseid=f,b.get("/api/data/vcases/vcaseform?vcase="+c.vcaseid+(void 0==h?"":"&nav="+h+"&dt="+e)).success(function(e,b,f,h){if("empty"!=e){g&&a.scrollTo("seriesgrid");c.vcase=e;c.res=c.vcase.data.split(",");e=[0,0,0,0,0,0,0,0,0];for(b=0;b<c.res.length;b++)switch(c.res[b]){case "0":e[0]++;break;case "1":case "2":case "6":case "9":e[1]++;break;case "3":e[3]++;
break;case "4":e[4]++;break;case "5":e[5]++;break;case "7":e[7]++;break;case "8":e[8]++}c.sdetail=e}}))};c.clr="#ee0 #0c0 #fa6 #fbf #acf #fff #bb0 #eb0 #07e #a60".split(" ");c.getColor=function(a){return c.clr[a]};c.getClz=function(a){return"c"+a};c.getBorder=function(a,b){return-1!=(","+c.changes[a]+",").indexOf(","+b+",")?"2px solid #008":""};c.history=function(a){m.open({animation:!0,templateUrl:"casehistory.html",controller:"caseHistoryCtrl",size:"sm",resolve:{casenum:function(){return a}}}).result.then(function(a){},
function(){})}}]);angular.module("statsApp").controller("caseHistoryCtrl",["$scope","$http","$uibModalInstance","casenum",function(b,c,d,a){b.casenum=a;b.chgloaded=!1;c.get("/api/data/vcases/?a=history&casenum="+a).success(function(a,c,d,f){b.casehist=a;b.chgloaded=!0});b.ok=function(){d.close("ok")};b.cancel=function(){d.dismiss("cancel")};b.statnames="Received;Approved;Rejected;RFE Req;Other;Not Form I-129;Transferred;RFE resp rec;Decision Notice;Withdrawn".split(";");b.getStatus=function(a){return b.statnames[a]}}]);
angular.module("statsApp").controller("helpCtrl",["$http","$scope","$location",function(b,c,d){b.get("/api/data/vcases/test?a=getadmins").success(function(a,b,d,r){c.admins=a})}]);angular.module("statsApp").controller("historyCtrl",["$http","$scope",function(b,c){b.get("/charts?t=0").success(function(b,a,k,m){c.charts=b.slice().reverse()})}]);
angular.module("statsApp").controller("changesCtrl",["$http","$scope",function(b,c){b.get("/api/reports?rep=changes").success(function(b,a,k,m){c.rep=b;c.reptot={chgs:0};for(b=0;b<c.rep.length;b++)c.reptot.chgs+=c.rep[b].chgs})}]);angular.module("statsApp").controller("rferesCtrl",["$http","$scope",function(b,c){b.get("/api/reports?rep=rferes").success(function(b,a,k,m){c.rep=b;c.reptot={app:0,dnm:0};for(b=0;b<c.rep.length;b++)c.reptot.app+=c.rep[b].app,c.reptot.dnm+=c.rep[b].dnm})}]);
angular.module("statsApp").controller("indexCtrl",["$http","$scope","$location","usersvc","$window",function(b,c,d,a,k){c.loggedin=!1;c.signupalert=!1;c.user={name:localStorage.getItem("wt_name"),id:localStorage.getItem("wt_id")};c.signup=function(){a.signup(function(a){"cancel"!=a&&(c.signupalert=!0)})};c.logout=function(){a.logout(function(){c.loggedin=!1;c.prof=null;d.path("/welcome")})};c.login=function(){a.login(function(a){"success"==a&&(c.loggedin=!0,d.path("/profile"))})}}]);
window.chartColors={rec:"#cc0",rfe:"#e4b",rrr:"#fa0",dnm:"#09f",oth:"#8ce",app:"#0b0",trf:"#aa6",wtd:"#c64"};window.chartColorsRGB={rec:"rgba(255, 255, 0, 0.6)",rfe:"rgba(255, 0, 255, 0.6)",app:"rgba(0, 255, 0, 0.6)"};Chart.defaults.global.defaultFontColor="#fff";
window.getopts17=function(b){return{type:"bar",data:b,options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{barThickness:4,ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1},stacked:!0}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{max:1E3,beginAtZero:!0},stacked:!0}]}}}};
angular.module("statsApp").controller("vcaselistCtrl17",["$http","$scope","$rootScope","anchorSmoothScroll","$location","$uibModal","$log",function(b,c,d,a,k,m,r){c.loadtrends=function(){b.get("/api/data/vcases17/test?a=trends").success(function(a,c,b,g){g=document.getElementById("trends_eac").getContext("2d");c=[];for(b=0;b<a.length;b++)c.push(a[b].dt.substring(5));var e=[];for(b=0;b<a.length;b++)e.push(a[b].erec);var h=[];for(b=0;b<a.length;b++)h.push(a[b].eapp);var f=[];for(b=0;b<a.length;b++)f.push(a[b].erfe);
var n=[];for(b=0;b<a.length;b++)n.push(a[b].errr);var d=[];for(b=0;b<a.length;b++)d.push(a[b].ednm);new Chart(g,{type:"line",data:{labels:c,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:e},{borderColor:window.chartColors.rfe,label:"RFE",data:f},{borderColor:window.chartColors.app,label:"APP",data:h},{borderColor:window.chartColors.rrr,label:"RESP",data:n},{borderColor:window.chartColors.dnm,label:"DNM",data:d}]},options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,
elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0,max:3E4}}]}}});g=document.getElementById("trends_wac").getContext("2d");e=[];for(b=0;b<a.length;b++)e.push(a[b].wrec);h=[];for(b=0;b<a.length;b++)h.push(a[b].wapp);f=[];for(b=0;b<a.length;b++)f.push(a[b].wrfe);n=[];for(b=0;b<a.length;b++)n.push(a[b].wrrr);d=[];for(b=0;b<a.length;b++)d.push(a[b].wdnm);new Chart(g,
{type:"line",data:{labels:c,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:e},{borderColor:window.chartColors.rfe,label:"RFE",data:f},{borderColor:window.chartColors.app,label:"APP",data:h},{borderColor:window.chartColors.rrr,label:"RESP",data:n},{borderColor:window.chartColors.dnm,label:"DNM",data:d}]},options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},
gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0,max:3E4}}]}}})})};c.stacksloaded=!1;c.loadvcases=function(){b.get("/api/data/vcases17/stackedcols?pre=EAC").success(function(a,b,e,g){c.stacksloaded=!0;b=[];e=[];g=[];for(var h=[],f=[],d=[],n=[],q=0;q<a.length;q++)b.push(a[q].id.substring(5,8)+"-"+a[q].id.substring(8,10)),e.push(a[q].rec),g.push(a[q].rfe),d.push(a[q].rrr),n.push(a[q].dnm),h.push(a[q].trf),f.push(a[q].app);a={labels:b,backgroundColor:"rgba(185, 214, 200, 0.75)",
borderColor:"rgba(255, 255, 255, 0.5)",datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:e},{backgroundColor:window.chartColors.trf,label:"TRF",data:h},{backgroundColor:window.chartColors.rfe,label:"RFE",data:g},{backgroundColor:window.chartColors.rrr,label:"RESP",data:d},{backgroundColor:window.chartColors.dnm,label:"DNM",data:n},{backgroundColor:window.chartColors.app,label:"APP",data:f}]};b=document.getElementById("canvas_eac").getContext("2d");window.myBar=new Chart(b,window.getopts17(a))});
b.get("/api/data/vcases17/stackedcols?pre=WAC").success(function(a,c,b,g){c=[];b=[];g=[];for(var e=[],h=[],f=[],n=0;n<a.length;n++)c.push(a[n].id.substring(5,8)+"-"+a[n].id.substring(8,10)),b.push(a[n].rec),g.push(a[n].rfe),h.push(a[n].rrr),f.push(a[n].dnm),e.push(a[n].app);a={labels:c,backgroundColor:"rgba(185, 214, 200, 0.75)",borderColor:"rgba(255, 255, 255, 0.5)",datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:b},{backgroundColor:window.chartColors.rfe,label:"RFE",data:g},{backgroundColor:window.chartColors.rrr,
label:"RESP",data:h},{backgroundColor:window.chartColors.dnm,label:"DNM",data:f},{backgroundColor:window.chartColors.app,label:"APP",data:e}]};c=document.getElementById("canvas_wac").getContext("2d");window.myBar=new Chart(c,window.getopts17(a))})};c.loadtrends();c.loadvcases();c.eac2=[];for(d=0;20>d;d++)c.eac2[d]=Array(6).fill(0);c.wac2=[];for(d=0;20>d;d++)c.wac2[d]=Array(6).fill(0);c.msloaded=!1;c.sortcol="dt";c.sortdir="desc";c.loadmseries=function(a,h){c.msloaded=!1;c.mpage=1;c.changes={};c.mseries=
[];c.eacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};c.wacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};b.get("/api/data/vcases17/test?a=mseries&sortcol="+a+"&sortdir="+h).success(function(a,b,h,f){c.mstats=a;a=null;b=!0;h=[0,0,0,0,0,0,0];f=[0,0,0,0,0,0,0];c.eacmstatstot=0;for(var e=c.wacmstatstot=0;e<c.mstats.length;e++){var l=c.mstats[e];l.id.startsWith("EAC")?c.eacmstatstot++:c.wacmstatstot++;var g=parseInt(l.id.substring(5,8)),d=parseInt(l.id.substring(8,10));"E"==l.id.charAt(0)?c.eac2[g-
132][d-50]=1:c.wac2[g-132][d-50]=1;null==a&&(a=l.chgdt.substring(0,10));a==l.chgdt.substring(0,10)?c.mstats[e].cdt=!1:(b=!1,c.mstats[e].cdt=!0,a=l.chgdt.substring(0,10));c.changes[l.id]=l.chgs;c.mseries.push(l.id);g=l.id.startsWith("EAC")?c.eacmstot:c.wacmstot;g.rec+=l.rec;g.wtd+=l.wtd;g.rfe+=l.rfe;g.rrr+=l.rrr;g.app+=l.app;g.dnm+=l.dnm;g.chg+=""==l.chgs?0:l.chgs.split(",").length;l.eactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};l.wactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};g=l.id.startsWith("EAC")?
l.eactchgs:l.wactchgs;if(null!=l.chgst){for(var d=l.chgst.split(","),p=0;p<d.length;p++)d[p].endsWith("7")?g.cresp++:d[p].endsWith("8")?g.cdnm++:d[p].endsWith("3")?g.crfe++:"71"==d[p]?g.app2++:d[p].endsWith("1")&&g.app1++;l.tchgs=g;l.id.startsWith("EAC");b&&(h[0]+=""==l.chgs||l.id.startsWith("WAC")?0:l.chgs.split(",").length,h[1]+=l.eactchgs.crfe,h[2]+=l.eactchgs.cresp,h[3]+=l.eactchgs.cdnm,h[4]+=l.eactchgs.app1,h[5]+=l.eactchgs.app2,f[0]+=""==l.chgs||l.id.startsWith("EAC")?0:l.chgs.split(",").length,
f[1]+=l.wactchgs.crfe,f[2]+=l.wactchgs.cresp,f[3]+=l.wactchgs.cdnm,f[4]+=l.wactchgs.app1,f[5]+=l.wactchgs.app2)}}c.msloaded=!0;c.vcaseid||(c.vcaseid=c.mseries[Math.floor(Math.random()*c.mseries.length)],c.getvcase(c.vcaseid,"latest",null,!1));c.eaccfdtstat=h;c.waccfdtstat=f})};c.loadmseries(c.sortcol,c.sortdir);b.get("/api/data/vcases17/test?a=getadmins").success(function(a,b,e,g){c.admins=a});c.setsort=function(a){c.sortdir=c.sortcol==a?""==c.sortdir?"desc":"":"dt"==a?"desc":"";c.sortcol=a;c.loadmseries(c.sortcol,
c.sortdir)};c.sortclr=function(a){return c.sortcol==a?""==c.sortdir?"#cdf":"#fdc":""};c.vcaseform=function(a){k.path("/vcases/"+a)};c.getAgeDays=function(a){a=a.split(" ")[0].split("-");a=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),0,0,0);a.setTime(a.getTime()-6E4*a.getTimezoneOffset());return Math.floor(Math.floor((new Date-a)/1E3)/86400)};c.getMsbg=function(a){a=c.mseries.indexOf(a);if(-1==a)return"#fff";a=c.mstats[a];if(a.chguser.startsWith("*"))return"#ccffff";switch(c.getAgeDays(a.chgdt)){case 0:return"#bbf8bb";
case 1:return"#f6faaa";case 2:return"#ffddaa";case 3:return"#ffc8e0"}return"#dce4ff"};c.getseriesrow=function(a){null!=a&&b.get("/api/data/vcases17/test?a=seriesrow&rowid="+a).success(function(a,b,f,l){if("empty"!=a){c.vcaseid=null;b=[0,0,0,0,0,0,0,0,0];for(f=0;f<a.data.length;f++)for(a.data[f].res=a.data[f].data.split(","),l=0;l<a.data[f].res.length;l++)switch(a.data[f].res[l].charAt(0)){case "0":b[0]++;break;case "1":b[1]++;break;case "2":b[2]++;break;case "3":b[3]++;break;case "4":b[4]++;break;
case "5":b[5]++;break;case "6":b[6]++;break;case "7":b[7]++;break;case "8":b[8]++}c.rowdetail=b;c.seriesrow=a}})};c.getvcase=function(f,h,e,g){null!=f&&(c.vcaseid=f,b.get("/api/data/vcases17/vcaseform?vcase="+c.vcaseid+(void 0==h?"":"&nav="+h+"&dt="+e)).success(function(b,e,h,f){if("empty"!=b){c.seriesrow=null;g&&a.scrollTo("seriesgrid");c.vcase=b;c.res=c.vcase.data.split(",");e=[0,0,0,0,0,0,0,0,0];for(b=0;b<c.res.length;b++)switch(c.res[b].charAt(0)){case "0":e[0]++;break;case "a":e[1]++;break;case "1":e[1]++;
break;case "2":e[2]++;break;case "3":e[3]++;break;case "4":e[4]++;break;case "5":e[5]++;break;case "6":e[6]++;break;case "7":e[7]++;break;case "8":e[8]++}c.sdetail=e;e=document.getElementById("schart").getContext("2d");h=[];for(b=0;b<c.vcase.stats.length;b++)h.push(c.vcase.stats[b].dt.substring(5));f=[];for(b=0;b<c.vcase.stats.length;b++)f.push(c.vcase.stats[b].rec);var l=[];for(b=0;b<c.vcase.stats.length;b++)l.push(c.vcase.stats[b].app);var d=[];for(b=0;b<c.vcase.stats.length;b++)d.push(c.vcase.stats[b].rfe);
var n=[];for(b=0;b<c.vcase.stats.length;b++)n.push(c.vcase.stats[b].rrr);var p=[];for(b=0;b<c.vcase.stats.length;b++)p.push(c.vcase.stats[b].dnm);new Chart(e,{type:"line",data:{labels:h,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:f},{borderColor:window.chartColors.rfe,label:"RFE",data:d},{borderColor:window.chartColors.rrr,label:"RESP",data:n},{borderColor:window.chartColors.app,label:"APP",data:l},{borderColor:window.chartColors.dnm,label:"DNM",data:p}]},options:{title:{display:!1},
tooltips:{mode:"index",intersect:!1},responsive:!0,elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0}}]}}})}}))};c.clr={0:"#ee0",1:"#0c0",2:"#fa6",3:"#fbf",4:"#ace",5:"#fff",6:"#bb0",7:"#eb0",8:"#07e",9:"#a60",a:"#4f0"};c.echg={0:"Received",1:"Approved",2:"Rejected",3:"RFE",4:"Other",5:"Not I-129",6:"Transferred",7:"RFE Resp",8:"DNM",9:"Withdrawn",a:"RFE-Approved"};
c.getColor=function(a){return c.clr[a]};c.getDetail=function(a){return void 0==a||"5"==a?"":c.echg[a.charAt(0)]+" "+parseInt(a.charAt(1),36)+"-"+parseInt(a.charAt(2),36)+"-"+parseInt(a.charAt(3),36)};c.getClz=function(a){return"c"+a};c.getBorder=function(a,b){return-1!=(","+c.changes[a]+",").indexOf(","+b+",")?"2px solid #008":""};c.history=function(a){m.open({animation:!0,templateUrl:"tracker17/casehistory.html",controller:"caseHistoryCtrl17",size:"sm",resolve:{casenum:function(){return a}}}).result.then(function(a){},
function(){})}}]);
angular.module("statsApp").controller("caseHistoryCtrl17",["$scope","$http","$uibModalInstance","casenum",function(b,c,d,a){b.casenum=a;b.chgloaded=!1;c.get("/api/data/vcases17/?a=history&casenum="+a).success(function(a,c,d,f){b.chgloaded=!0;b.imgdata="data:image/png;base64,"+a});b.ok=function(){d.close("ok")};b.cancel=function(){d.dismiss("cancel")};b.statnames={0:"Received",1:"Approved",2:"Rejected",3:"RFE Req",4:"Other",5:"Not Form I-129",6:"Transferred",7:"RFE resp rec",8:"Decision Notice",9:"Withdrawn",
a:"RFE-Approved"};b.getStatus=function(a){return b.statnames[a]}}]);angular.module("statsApp").controller("indexCtrl17",["$http","$scope","$location","usersvc","$window",function(b,c,d,a,k){c.user={name:localStorage.getItem("wt_name"),id:localStorage.getItem("wt_id")}}]);
angular.module("statsApp").controller("cmtCtrl17",["countries","$window","$document","$scope","$http","anchorSmoothScroll","$attrs","$interval",function(b,c,d,a,k,m,r,f){k.get("/api/user/test?a=checkadmin&id="+localStorage.getItem("wt_id")).success(function(c,b,f,l){a.uadmin="success"==c.status});$(document).ready(function(){$("#emoji").click(function(a){a.stopPropagation();$("#epop").slideToggle("fast")});$("#epop span").on("click",function(a){var c=$("#cmtbox");c.val(c.val()+" "+a.target.innerText);
angular.element(c).triggerHandler("input");a.stopPropagation()})});$(document).on("click",function(){$("#epop").hide()});a.countries=b;a.sz=50;a.topic="2";a.fltrmode=!1;a.uinfoedit=!1;a.cmtloaded=!1;a.editmode=!1;a.fltrdata=!1;a.page=1;a.fltr={};a.qtxt="";a.qname="";a.qpk=0;a.cmt={name:localStorage.getItem("wt_name")};a.blank=function(a){return null==a||void 0==a||"undefined"==a?"":a};a.uinfo={};switch(a.topic){case "2":a.uinfo.name=a.blank(localStorage.getItem("wt_name")),a.uinfo.status=a.blank(localStorage.getItem("wt_status")),
a.uinfo.center=a.blank(localStorage.getItem("wt_center")),a.uinfo.series=a.blank(localStorage.getItem("wt_series")),a.uinfo.rfereason=a.blank(localStorage.getItem("wt_rfereason")),a.uinfo.degree=a.blank(localStorage.getItem("wt_degree")),a.uinfo.processing=a.blank(localStorage.getItem("wt_processing")),a.uinfo.skill=a.blank(localStorage.getItem("wt_skill")),a.uinfo.company=a.blank(localStorage.getItem("wt_company")),a.uinfo.empcity=a.blank(localStorage.getItem("wt_empcity")),a.uinfo.country=a.blank(localStorage.getItem("wt_country")),
a.statusopts=";RFE;RFE Resp Sent;Received;Approved;Name Updated;Other".split(";")}a.loadcomments=function(c){var b=localStorage.getItem("wt_id");null==b&&(b="");a.fltrmode?k.post("/api/data/comments?action=filter&topic="+a.topic+"&u="+b+"&p="+c+"&sz="+a.sz,a.fltr).success(function(b,e,h,f){a.cset=b;a.page=c;a.fltrdata=!0;a.cmtloaded=!0}):a.rendercomments(c,b)};a.rendercomments=function(c,b){a.cmtloaded=!1;k.get("/api/data/comments?topic="+a.topic+"&u="+b+"&p="+c+"&sz="+a.sz).success(function(b,e,
h,f){a.cset=b;a.page=c;a.cmtloaded=!0})};a.filtercomments=function(c){a.loadcomments(1)};a.upvote=function(a){if(!a.owner){var c=JSON.parse(localStorage.getItem("wt_votes"));null==c&&(c=[]);-1==c.indexOf(a.pk)&&(a.votes++,c.push(a.pk),localStorage.setItem("wt_votes",JSON.stringify(c)),k.post("/api/data/comments?action=upvote",a.pk).success(function(a,c,b,e){}))}};a.showfltr=function(c){a.fltrmode=c};a.clearfltr=function(){document.getElementById("form2").reset();a.fltrdata=!1;a.fltrmode=!1;a.loadcomments(1)};
a.canceluinfo=function(){a.uinfo.name=localStorage.getItem("wt_name");a.uinfo.status=localStorage.getItem("wt_status");a.uinfo.center=localStorage.getItem("wt_center");a.uinfo.series=localStorage.getItem("wt_series");a.uinfo.rfereason=localStorage.getItem("wt_rfereason");a.uinfo.degree=localStorage.getItem("wt_degree");a.uinfo.processing=localStorage.getItem("wt_processing");a.uinfo.skill=localStorage.getItem("wt_skill");a.uinfo.company=localStorage.getItem("wt_company");a.uinfo.empcity=localStorage.getItem("wt_empcity");
a.uinfo.country=localStorage.getItem("wt_country");a.uinfoedit=!1};a.saveuinfo=function(){localStorage.setItem("wt_name",a.blank(a.uinfo.name));localStorage.setItem("wt_status",a.blank(a.uinfo.status));localStorage.setItem("wt_center",a.blank(a.uinfo.center));localStorage.setItem("wt_series",a.blank(a.uinfo.series));localStorage.setItem("wt_rfereason",a.blank(a.uinfo.rfereason));localStorage.setItem("wt_degree",a.blank(a.uinfo.degree));localStorage.setItem("wt_processing",a.blank(a.uinfo.processing));
localStorage.setItem("wt_skill",a.blank(a.uinfo.skill));localStorage.setItem("wt_company",a.blank(a.uinfo.company));localStorage.setItem("wt_empcity",a.blank(a.uinfo.empcity));localStorage.setItem("wt_country",a.blank(a.uinfo.country));a.uinfoedit=!1;var c=localStorage.getItem("wt_id");null==c&&(c=a.guid(),localStorage.setItem("wt_id",c));a.uinfo.id=c;k.post("/api/data/comments?action=uinfo",a.uinfo).success(function(a,c,b,h){})};a.addcomment=function(){if(null==a.uinfo.name||""==a.uinfo.name||void 0==
a.uinfo.name)alert("Please provide your name and other info by clicking on 'edit' below and please save it before proceeding with comment");else{var c=localStorage.getItem("wt_id");null==c&&(c=a.guid(),localStorage.setItem("wt_id",c));a.empty(a.cmt.txt)||(c={user:c,name:a.uinfo.name,topic:a.topic,txt:a.cmt.txt},a.cmt.txt=null,""!=a.qtxt&&(c.qtxt=300>a.qtxt.length?a.qtxt:a.qtxt.substring(0,297)+"...",c.qname=a.qname,c.qpk=a.qpk),k.post("/api/data/comments",c).success(function(c,b,h,f){a.chatclient.sendMessage(c);
b=JSON.parse(localStorage.getItem("wt_cmts"));null==b&&(b=[]);a.qtxt="";b.push(parseInt(c.pk));localStorage.setItem("wt_cmts",JSON.stringify(b))}),a.ontyping())}};a.replycmt=function(b){a.qtxt=b.txt;a.qname=b.name;a.qpk=b.pk;m.scrollTo("cmtsection");c.document.getElementById("cmtbox").focus()};a.editcmt=function(c){if(!a.empty(c.txt)){var b=localStorage.getItem("wt_id");null!=b&&k.post("/api/data/comments?action=edit",{pk:c.pk,user:b,txt:c.txt}).success(function(c,b,e,f){a.loadcomments(a.page)});
a.editmode=!1}};a.rmcmt=function(c){if(confirm("Are you sure to delete this comment?")){var b=localStorage.getItem("wt_id");null!=b&&k.post("/api/data/comments?action=del",{pk:c.pk,user:b}).success(function(c,b,e,f){a.loadcomments(a.page)})}};a.modcmt=function(c){if(confirm("The comment text will be replaced by '[deleted]'. Are you sure to mod this comment?")){var b=localStorage.getItem("wt_id");null!=b&&k.post("/api/data/comments?action=mod",{pk:c.pk,user:b}).success(function(c,b,e,f){a.loadcomments(a.page)})}};
a.guid=function(){return Math.random().toString(36).substring(2,8)+Math.random().toString(36).substring(2,8)};a.empty=function(a){return null==a?!0:""==a.trim()?!0:!1};a.links2html=function(a){return a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target=\"_blank\">$1</a>")};a.loadcomments(1);a.cmd={connect:"/connect ",disconnect:"/disconnect ",broadcast:"/broadcast "};a.userlen="0";a.utyping="";a.chatclient={socket:null,userlen:null,init:function(c){socket=
new WebSocket("wss://worktheme.com/");socket.onopen=function(){socket.send(a.cmd.connect+c)};socket.onmessage=function(c){c=c.data;if(c.startsWith("$$users:")){var b=document.getElementById("userlen");b.innerText="online: "+c.substring(8)}else if(c.startsWith("$$ty:")){var e=JSON.parse(c.substring(5)),b=document.getElementById("utyping");b.innerText=7<c.length?"typing: "+e.join(", "):""}else{localStorage.getItem("wt_id");c=JSON.parse(c);b=JSON.parse(localStorage.getItem("wt_cmts"));null==b&&(b=[]);
for(e=b.length-1;0<=e;e--)if(b[e]==c.pk){c.owner=!0;break}a.cset.cmts.unshift(c);a.$apply()}};socket.onclose=function(){}},sendMessage:function(c){socket.send(a.cmd.broadcast+JSON.stringify(c))},addTyping:function(){socket.send("/ty1 "+a.uinfo.name)},removeTyping:function(){socket.send("/ty2 "+a.uinfo.name)},close:function(){socket.close()}};a.newcomment=function(){};a.typing=!1;a.ontyping=function(){a.empty(a.cmt.txt)?a.typing&&(a.chatclient.removeTyping(),a.typing=!1):a.typing||(a.chatclient.addTyping(),
a.typing=!0)};a.chatclient.init(a.uinfo.name)}]);window.getopts18=function(b){return{type:"bar",data:b,options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{barThickness:4,ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1},stacked:!0}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{max:1E3,beginAtZero:!0},stacked:!0}]}}}};
angular.module("statsApp").controller("vcaselistCtrl18",["$http","$scope","$rootScope","anchorSmoothScroll","$location","$uibModal","$log",function(b,c,d,a,k,m,r){c.loadtrends=function(){b.get("/api/data/vcases18/test?a=trends").success(function(a,c,b,d){d=document.getElementById("trends_eac").getContext("2d");c=[];for(b=0;b<a.length;b++)c.push(a[b].dt.substring(5));var e=[];for(b=0;b<a.length;b++)e.push(a[b].erec);var f=[];for(b=0;b<a.length;b++)f.push(a[b].eapp);var h=[];for(b=0;b<a.length;b++)h.push(a[b].erfe);
var g=[];for(b=0;b<a.length;b++)g.push(a[b].errr);var k=[];for(b=0;b<a.length;b++)k.push(a[b].ednm);new Chart(d,{type:"line",data:{labels:c,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:e},{borderColor:window.chartColors.rfe,label:"RFE",data:h},{borderColor:window.chartColors.app,label:"APP",data:f},{borderColor:window.chartColors.rrr,label:"RESP",data:g},{borderColor:window.chartColors.dnm,label:"DNM",data:k}]},options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,
elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0,max:5E4}}]}}});d=document.getElementById("trends_wac").getContext("2d");e=[];for(b=0;b<a.length;b++)e.push(a[b].wrec);f=[];for(b=0;b<a.length;b++)f.push(a[b].wapp);h=[];for(b=0;b<a.length;b++)h.push(a[b].wrfe);g=[];for(b=0;b<a.length;b++)g.push(a[b].wrrr);k=[];for(b=0;b<a.length;b++)k.push(a[b].wdnm);new Chart(d,
{type:"line",data:{labels:c,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:e},{borderColor:window.chartColors.rfe,label:"RFE",data:h},{borderColor:window.chartColors.app,label:"APP",data:f},{borderColor:window.chartColors.rrr,label:"RESP",data:g},{borderColor:window.chartColors.dnm,label:"DNM",data:k}]},options:{title:{display:!1},tooltips:{mode:"index",intersect:!1},responsive:!0,elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},
gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0,max:5E4}}]}}})})};c.stacksloaded=!1;c.loadvcases=function(){b.get("/api/data/vcases18/stackedcols?pre=EAC").success(function(a,b,e,d){c.stacksloaded=!0;b=[];e=[];d=[];for(var h=[],f=[],g=[],n=[],k=0;k<a.length;k++)b.push(a[k].id.substring(5,8)+"-"+a[k].id.substring(8,10)),e.push(a[k].rec),d.push(a[k].rfe),g.push(a[k].rrr),n.push(a[k].dnm),h.push(a[k].trf),f.push(a[k].app);a={labels:b,backgroundColor:"rgba(185, 214, 200, 0.75)",
borderColor:"rgba(255, 255, 255, 0.5)",datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:e},{backgroundColor:window.chartColors.trf,label:"TRF",data:h},{backgroundColor:window.chartColors.rfe,label:"RFE",data:d},{backgroundColor:window.chartColors.rrr,label:"RESP",data:g},{backgroundColor:window.chartColors.dnm,label:"DNM",data:n},{backgroundColor:window.chartColors.app,label:"APP",data:f}]};b=document.getElementById("canvas_eac").getContext("2d");window.myBar=new Chart(b,window.getopts18(a))});
b.get("/api/data/vcases18/stackedcols?pre=WAC").success(function(a,c,b,d){c=[];b=[];d=[];for(var e=[],h=[],f=[],g=0;g<a.length;g++)c.push(a[g].id.substring(5,8)+"-"+a[g].id.substring(8,10)),b.push(a[g].rec),d.push(a[g].rfe),h.push(a[g].rrr),f.push(a[g].dnm),e.push(a[g].app);a={labels:c,backgroundColor:"rgba(185, 214, 200, 0.75)",borderColor:"rgba(255, 255, 255, 0.5)",datasets:[{backgroundColor:window.chartColors.rec,label:"REC",data:b},{backgroundColor:window.chartColors.rfe,label:"RFE",data:d},{backgroundColor:window.chartColors.rrr,
label:"RESP",data:h},{backgroundColor:window.chartColors.dnm,label:"DNM",data:f},{backgroundColor:window.chartColors.app,label:"APP",data:e}]};c=document.getElementById("canvas_wac").getContext("2d");window.myBar=new Chart(c,window.getopts18(a))})};c.loadtrends();c.loadvcases();c.eac2=[];for(d=0;45>d;d++)c.eac2[d]=Array(6).fill(0);c.wac2=[];for(d=0;45>d;d++)c.wac2[d]=Array(6).fill(0);c.msloaded=!1;c.sortcol="dt";c.sortdir="desc";c.loadmseries=function(a,h){c.msloaded=!1;c.mpage=1;c.changes={};c.mseries=
[];c.eacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};c.wacmstot={rec:0,wtd:0,rfe:0,rrr:0,app:0,dnm:0,chg:0};b.get("/api/data/vcases18/test?a=mseries&sortcol="+a+"&sortdir="+h).success(function(a,b,h,f){c.mstats=a;a=null;b=!0;h=[0,0,0,0,0,0,0];f=[0,0,0,0,0,0,0];c.eacmstatstot=0;for(var e=c.wacmstatstot=0;e<c.mstats.length;e++){var d=c.mstats[e];d.id.startsWith("EAC")?c.eacmstatstot++:c.wacmstatstot++;var g=parseInt(d.id.substring(5,8)),l=parseInt(d.id.substring(8,10));"E"==d.id.charAt(0)?c.eac2[g-
130][l-50]=1:c.wac2[g-130][l-50]=1;null==a&&(a=d.chgdt.substring(0,10));a==d.chgdt.substring(0,10)?c.mstats[e].cdt=!1:(b=!1,c.mstats[e].cdt=!0,a=d.chgdt.substring(0,10));c.changes[d.id]=d.chgs;c.mseries.push(d.id);g=d.id.startsWith("EAC")?c.eacmstot:c.wacmstot;g.rec+=d.rec;g.wtd+=d.wtd;g.rfe+=d.rfe;g.rrr+=d.rrr;g.app+=d.app;g.dnm+=d.dnm;g.chg+=""==d.chgs?0:d.chgs.split(",").length;d.eactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};d.wactchgs={crfe:0,cresp:0,cdnm:0,app1:0,app2:0};g=d.id.startsWith("EAC")?
d.eactchgs:d.wactchgs;if(null!=d.chgst){for(var l=d.chgst.split(","),k=0;k<l.length;k++)l[k].endsWith("7")?g.cresp++:l[k].endsWith("8")?g.cdnm++:l[k].endsWith("3")?g.crfe++:"71"==l[k]?g.app2++:l[k].endsWith("1")&&g.app1++;d.tchgs=g;d.id.startsWith("EAC");b&&(h[0]+=""==d.chgs||d.id.startsWith("WAC")?0:d.chgs.split(",").length,h[1]+=d.eactchgs.crfe,h[2]+=d.eactchgs.cresp,h[3]+=d.eactchgs.cdnm,h[4]+=d.eactchgs.app1,h[5]+=d.eactchgs.app2,f[0]+=""==d.chgs||d.id.startsWith("EAC")?0:d.chgs.split(",").length,
f[1]+=d.wactchgs.crfe,f[2]+=d.wactchgs.cresp,f[3]+=d.wactchgs.cdnm,f[4]+=d.wactchgs.app1,f[5]+=d.wactchgs.app2)}}c.msloaded=!0;c.vcaseid||(c.vcaseid=c.mseries[Math.floor(Math.random()*c.mseries.length)],c.getvcase(c.vcaseid,"latest",null,!1));c.eaccfdtstat=h;c.waccfdtstat=f})};c.loadmseries(c.sortcol,c.sortdir);b.get("/api/data/vcases18/test?a=getadmins").success(function(a,b,d,g){c.admins=a});c.setsort=function(a){c.sortdir=c.sortcol==a?""==c.sortdir?"desc":"":"dt"==a?"desc":"";c.sortcol=a;c.loadmseries(c.sortcol,
c.sortdir)};c.sortclr=function(a){return c.sortcol==a?""==c.sortdir?"#cdf":"#fdc":""};c.vcaseform=function(a){k.path("/vcases/"+a)};c.getAgeDays=function(a){a=a.split(" ")[0].split("-");a=new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]),0,0,0);a.setTime(a.getTime()-6E4*a.getTimezoneOffset());return Math.floor(Math.floor((new Date-a)/1E3)/86400)};c.getMsbg=function(a){a=c.mseries.indexOf(a);if(-1==a)return"#fff";a=c.mstats[a];if(a.chguser.startsWith("*"))return"#ccffff";switch(c.getAgeDays(a.chgdt)){case 0:return"#bbf8bb";
case 1:return"#f6faaa";case 2:return"#ffddaa";case 3:return"#ffc8e0"}return"#dce4ff"};c.getseriesrow=function(a){null!=a&&b.get("/api/data/vcases18/test?a=seriesrow&rowid="+a).success(function(a,b,d,f){if("empty"!=a){c.vcaseid=null;b=[0,0,0,0,0,0,0,0,0];for(d=0;d<a.data.length;d++)for(a.data[d].res=a.data[d].data.split(","),f=0;f<a.data[d].res.length;f++)switch(a.data[d].res[f].charAt(0)){case "0":b[0]++;break;case "1":b[1]++;break;case "2":b[2]++;break;case "3":b[3]++;break;case "4":b[4]++;break;
case "5":b[5]++;break;case "6":b[6]++;break;case "7":b[7]++;break;case "8":b[8]++}c.rowdetail=b;c.seriesrow=a}})};c.getvcase=function(d,h,e,g){null!=d&&(c.vcaseid=d,b.get("/api/data/vcases18/vcaseform?vcase="+c.vcaseid+(void 0==h?"":"&nav="+h+"&dt="+e)).success(function(b,d,h,e){if("empty"!=b){c.seriesrow=null;g&&a.scrollTo("seriesgrid");c.vcase=b;c.res=c.vcase.data.split(",");d=[0,0,0,0,0,0,0,0,0];for(b=0;b<c.res.length;b++)switch(c.res[b].charAt(0)){case "0":d[0]++;break;case "a":d[1]++;break;case "1":d[1]++;
break;case "2":d[2]++;break;case "3":d[3]++;break;case "4":d[4]++;break;case "5":d[5]++;break;case "6":d[6]++;break;case "7":d[7]++;break;case "8":d[8]++}c.sdetail=d;d=document.getElementById("schart").getContext("2d");h=[];for(b=0;b<c.vcase.stats.length;b++)h.push(c.vcase.stats[b].dt.substring(5));e=[];for(b=0;b<c.vcase.stats.length;b++)e.push(c.vcase.stats[b].rec);var f=[];for(b=0;b<c.vcase.stats.length;b++)f.push(c.vcase.stats[b].app);var l=[];for(b=0;b<c.vcase.stats.length;b++)l.push(c.vcase.stats[b].rfe);
var k=[];for(b=0;b<c.vcase.stats.length;b++)k.push(c.vcase.stats[b].rrr);var m=[];for(b=0;b<c.vcase.stats.length;b++)m.push(c.vcase.stats[b].dnm);new Chart(d,{type:"line",data:{labels:h,datasets:[{borderColor:window.chartColors.rec,label:"REC",data:e},{borderColor:window.chartColors.rfe,label:"RFE",data:l},{borderColor:window.chartColors.rrr,label:"RESP",data:k},{borderColor:window.chartColors.app,label:"APP",data:f},{borderColor:window.chartColors.dnm,label:"DNM",data:m}]},options:{title:{display:!1},
tooltips:{mode:"index",intersect:!1},responsive:!0,elements:{point:{radius:0}},maintainAspectRatio:!1,scales:{xAxes:[{ticks:{autoSkip:!0,maxTicksLimit:22},gridLines:{display:!1}}],yAxes:[{gridLines:{display:!0,color:"#bbb"},ticks:{beginAtZero:!0}}]}}})}}))};c.clr={0:"#ee0",1:"#0c0",2:"#fa6",3:"#fbf",4:"#ace",5:"#fff",6:"#bb0",7:"#eb0",8:"#07e",9:"#a60",a:"#4f0"};c.echg={0:"Received",1:"Approved",2:"Rejected",3:"RFE",4:"Other",5:"Not I-129",6:"Transferred",7:"RFE Resp",8:"DNM",9:"Withdrawn",a:"RFE-Approved"};
c.getColor=function(a){return c.clr[a]};c.getDetail=function(a){return void 0==a||"5"==a?"":c.echg[a.charAt(0)]+" "+parseInt(a.charAt(1),36)+"-"+parseInt(a.charAt(2),36)+"-"+parseInt(a.charAt(3),36)};c.getClz=function(a){return"c"+a};c.getBorder=function(a,b){return-1!=(","+c.changes[a]+",").indexOf(","+b+",")?"2px solid #008":""};c.history=function(a){m.open({animation:!0,templateUrl:"tracker18/casehistory.html",controller:"caseHistoryCtrl18",size:"sm",resolve:{casenum:function(){return a}}}).result.then(function(a){},
function(){})}}]);
angular.module("statsApp").controller("caseHistoryCtrl18",["$scope","$http","$uibModalInstance","casenum",function(b,c,d,a){b.casenum=a;b.chgloaded=!1;c.get("/api/data/vcases18/?a=history&casenum="+a).success(function(a,c,d,f){b.chgloaded=!0;b.imgdata="data:image/png;base64,"+a});b.ok=function(){d.close("ok")};b.cancel=function(){d.dismiss("cancel")};b.statnames={0:"Received",1:"Approved",2:"Rejected",3:"RFE Req",4:"Other",5:"Not Form I-129",6:"Transferred",7:"RFE resp rec",8:"Decision Notice",9:"Withdrawn",
a:"RFE-Approved"};b.getStatus=function(a){return b.statnames[a]}}]);angular.module("statsApp").controller("indexCtrl18",["$http","$scope","$location","usersvc","$window",function(b,c,d,a,k){c.user={name:localStorage.getItem("wt_name"),id:localStorage.getItem("wt_id")}}]);
angular.module("statsApp").controller("cmtCtrl18",["countries","$window","$document","$scope","$http","anchorSmoothScroll","$attrs","$interval",function(b,c,d,a,k,m,r,f){k.get("/api/user/test?a=checkadmin&id="+localStorage.getItem("wt_id")).success(function(b,c,d,f){a.uadmin="success"==b.status});$(document).ready(function(){$("#emoji").click(function(a){a.stopPropagation();$("#epop").slideToggle("fast")});$("#epop span").on("click",function(a){var b=$("#cmtbox");b.val(b.val()+" "+a.target.innerText);
angular.element(b).triggerHandler("input");a.stopPropagation()})});$(document).on("click",function(){$("#epop").hide()});a.countries=b;a.sz=50;a.topic="2";a.fltrmode=!1;a.uinfoedit=!1;a.cmtloaded=!1;a.editmode=!1;a.fltrdata=!1;a.page=1;a.fltr={};a.qtxt="";a.qname="";a.qpk=0;a.cmt={name:localStorage.getItem("wt_name")};a.blank=function(a){return null==a||void 0==a||"undefined"==a?"":a};a.uinfo={};switch(a.topic){case "2":a.uinfo.name=a.blank(localStorage.getItem("wt_name")),a.uinfo.status=a.blank(localStorage.getItem("wt_status")),
a.uinfo.center=a.blank(localStorage.getItem("wt_center")),a.uinfo.series=a.blank(localStorage.getItem("wt_series")),a.uinfo.rfereason=a.blank(localStorage.getItem("wt_rfereason")),a.uinfo.degree=a.blank(localStorage.getItem("wt_degree")),a.uinfo.processing=a.blank(localStorage.getItem("wt_processing")),a.uinfo.skill=a.blank(localStorage.getItem("wt_skill")),a.uinfo.company=a.blank(localStorage.getItem("wt_company")),a.uinfo.empcity=a.blank(localStorage.getItem("wt_empcity")),a.uinfo.country=a.blank(localStorage.getItem("wt_country")),
a.statusopts=";RFE;RFE Resp Sent;Received;Approved;Name Updated;Other".split(";")}a.loadcomments=function(b){var c=localStorage.getItem("wt_id");null==c&&(c="");a.fltrmode?k.post("/api/data/comments?action=filter&topic="+a.topic+"&u="+c+"&p="+b+"&sz="+a.sz,a.fltr).success(function(c,d,e,h){a.cset=c;a.page=b;a.fltrdata=!0;a.cmtloaded=!0}):a.rendercomments(b,c)};a.rendercomments=function(b,c){a.cmtloaded=!1;k.get("/api/data/comments?topic="+a.topic+"&u="+c+"&p="+b+"&sz="+a.sz).success(function(c,d,
e,h){a.cset=c;a.page=b;a.cmtloaded=!0})};a.filtercomments=function(b){a.loadcomments(1)};a.upvote=function(a){if(!a.owner){var b=JSON.parse(localStorage.getItem("wt_votes"));null==b&&(b=[]);-1==b.indexOf(a.pk)&&(a.votes++,b.push(a.pk),localStorage.setItem("wt_votes",JSON.stringify(b)),k.post("/api/data/comments?action=upvote",a.pk).success(function(a,b,c,d){}))}};a.showfltr=function(b){a.fltrmode=b};a.clearfltr=function(){document.getElementById("form2").reset();a.fltrdata=!1;a.fltrmode=!1;a.loadcomments(1)};
a.canceluinfo=function(){a.uinfo.name=localStorage.getItem("wt_name");a.uinfo.status=localStorage.getItem("wt_status");a.uinfo.center=localStorage.getItem("wt_center");a.uinfo.series=localStorage.getItem("wt_series");a.uinfo.rfereason=localStorage.getItem("wt_rfereason");a.uinfo.degree=localStorage.getItem("wt_degree");a.uinfo.processing=localStorage.getItem("wt_processing");a.uinfo.skill=localStorage.getItem("wt_skill");a.uinfo.company=localStorage.getItem("wt_company");a.uinfo.empcity=localStorage.getItem("wt_empcity");
a.uinfo.country=localStorage.getItem("wt_country");a.uinfoedit=!1};a.saveuinfo=function(){localStorage.setItem("wt_name",a.blank(a.uinfo.name));localStorage.setItem("wt_status",a.blank(a.uinfo.status));localStorage.setItem("wt_center",a.blank(a.uinfo.center));localStorage.setItem("wt_series",a.blank(a.uinfo.series));localStorage.setItem("wt_rfereason",a.blank(a.uinfo.rfereason));localStorage.setItem("wt_degree",a.blank(a.uinfo.degree));localStorage.setItem("wt_processing",a.blank(a.uinfo.processing));
localStorage.setItem("wt_skill",a.blank(a.uinfo.skill));localStorage.setItem("wt_company",a.blank(a.uinfo.company));localStorage.setItem("wt_empcity",a.blank(a.uinfo.empcity));localStorage.setItem("wt_country",a.blank(a.uinfo.country));a.uinfoedit=!1;var b=localStorage.getItem("wt_id");null==b&&(b=a.guid(),localStorage.setItem("wt_id",b));a.uinfo.id=b;k.post("/api/data/comments?action=uinfo",a.uinfo).success(function(a,b,c,d){})};a.addcomment=function(){if(null==a.uinfo.name||""==a.uinfo.name||void 0==
a.uinfo.name)alert("Please provide your name and other info by clicking on 'edit' below and please save it before proceeding with comment");else{var b=localStorage.getItem("wt_id");null==b&&(b=a.guid(),localStorage.setItem("wt_id",b));a.empty(a.cmt.txt)||(b={user:b,name:a.uinfo.name,topic:a.topic,txt:a.cmt.txt},a.cmt.txt=null,""!=a.qtxt&&(b.qtxt=300>a.qtxt.length?a.qtxt:a.qtxt.substring(0,297)+"...",b.qname=a.qname,b.qpk=a.qpk),k.post("/api/data/comments",b).success(function(b,c,d,h){a.chatclient.sendMessage(b);
c=JSON.parse(localStorage.getItem("wt_cmts"));null==c&&(c=[]);a.qtxt="";c.push(parseInt(b.pk));localStorage.setItem("wt_cmts",JSON.stringify(c))}),a.ontyping())}};a.replycmt=function(b){a.qtxt=b.txt;a.qname=b.name;a.qpk=b.pk;m.scrollTo("cmtsection");c.document.getElementById("cmtbox").focus()};a.editcmt=function(b){if(!a.empty(b.txt)){var c=localStorage.getItem("wt_id");null!=c&&k.post("/api/data/comments?action=edit",{pk:b.pk,user:c,txt:b.txt}).success(function(b,c,d,e){a.loadcomments(a.page)});
a.editmode=!1}};a.rmcmt=function(b){if(confirm("Are you sure to delete this comment?")){var c=localStorage.getItem("wt_id");null!=c&&k.post("/api/data/comments?action=del",{pk:b.pk,user:c}).success(function(b,c,d,e){a.loadcomments(a.page)})}};a.modcmt=function(b){if(confirm("The comment text will be replaced by '[deleted]'. Are you sure to mod this comment?")){var c=localStorage.getItem("wt_id");null!=c&&k.post("/api/data/comments?action=mod",{pk:b.pk,user:c}).success(function(b,c,d,e){a.loadcomments(a.page)})}};
a.guid=function(){return Math.random().toString(36).substring(2,8)+Math.random().toString(36).substring(2,8)};a.empty=function(a){return null==a?!0:""==a.trim()?!0:!1};a.links2html=function(a){return a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target=\"_blank\">$1</a>")};a.loadcomments(1);a.cmd={connect:"/connect ",disconnect:"/disconnect ",broadcast:"/broadcast "};a.userlen="0";a.utyping="";a.chatclient={socket:null,userlen:null,init:function(b){socket=
new WebSocket("wss://worktheme.com/");socket.onopen=function(){socket.send(a.cmd.connect+b)};socket.onmessage=function(b){b=b.data;if(b.startsWith("$$users:")){var c=document.getElementById("userlen");c.innerText="online: "+b.substring(8)}else if(b.startsWith("$$ty:")){var d=JSON.parse(b.substring(5)),c=document.getElementById("utyping");c.innerText=7<b.length?"typing: "+d.join(", "):""}else{localStorage.getItem("wt_id");b=JSON.parse(b);c=JSON.parse(localStorage.getItem("wt_cmts"));null==c&&(c=[]);
for(d=c.length-1;0<=d;d--)if(c[d]==b.pk){b.owner=!0;break}a.cset.cmts.unshift(b);a.$apply()}};socket.onclose=function(){}},sendMessage:function(b){socket.send(a.cmd.broadcast+JSON.stringify(b))},addTyping:function(){socket.send("/ty1 "+a.uinfo.name)},removeTyping:function(){socket.send("/ty2 "+a.uinfo.name)},close:function(){socket.close()}};a.newcomment=function(){};a.typing=!1;a.ontyping=function(){a.empty(a.cmt.txt)?a.typing&&(a.chatclient.removeTyping(),a.typing=!1):a.typing||(a.chatclient.addTyping(),
a.typing=!0)};a.chatclient.init(a.uinfo.name)}]);
